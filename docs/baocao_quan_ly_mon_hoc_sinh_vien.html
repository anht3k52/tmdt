<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Báo cáo đồ án – Hệ thống quản lý môn học sinh viên – Trường Đại học Điện Lực</title>
  <style>
    :root{--fg:#111;--muted:#444;--border:#ddd;--bg:#fff;--accent:#0a7}
    html,body{background:var(--bg);color:var(--fg)}
    body{font-family:Segoe UI,Roboto,Arial,Helvetica,sans-serif;margin:24px;line-height:1.6;max-width:980px}
    h1,h2,h3,h4{margin:16px 0 8px}
    h1{font-size:28px}
    h2{font-size:22px;border-bottom:1px solid var(--border);padding-bottom:4px}
    h3{font-size:18px;color:var(--muted)}
    .center{text-align:center}
    .muted{color:var(--muted)}
    .toc ol{margin:6px 0 6px 18px}
    .toc a{text-decoration:none;color:inherit}
    table{border-collapse:collapse;width:100%;margin:12px 0}
    th,td{border:1px solid #ccc;padding:8px;vertical-align:top}
    code,kbd{background:#f7f7f7;border:1px solid #eee;border-radius:4px;padding:0 4px}
    pre{background:#fafafa;border:1px solid #eee;border-radius:6px;padding:12px;overflow:auto}
    .figure{font-size:14px;color:var(--muted);margin-top:4px}
    .pagebreak{page-break-before:always;margin-top:24px}
  </style>
  <script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true, theme: 'default' });
  </script>
</head>
<body>
  <div class="center">
    <h3>TRƯỜNG ĐẠI HỌC ĐIỆN LỰC</h3>
    <h4>KHOA CÔNG NGHỆ THÔNG TIN</h4>
    <h1>ĐỒ ÁN – LẬP TRÌNH .NET</h1>
    <h2>ĐỀ TÀI: XÂY DỰNG HỆ THỐNG QUẢN LÝ MÔN HỌC SINH VIÊN</h2>
    <p><b>Sinh viên thực hiện:</b> NGUYỄN THỊ THU<br />
       <b>Giảng viên hướng dẫn:</b> PHƯƠNG VĂN CẢNH<br />
       <b>Lớp:</b> D12 - CNPM2 – <b>Chuyên ngành:</b> CÔNG NGHỆ PHẦN MỀM<br />
       <b>Niên khóa:</b> 2017 – 2022</p>
    <p class="muted">Hà Nội, tháng 06 năm 2021</p>
  </div>

  <div class="pagebreak"></div>

  <h2>TÓM TẮT</h2>
  <p>Báo cáo trình bày quá trình phân tích, thiết kế, cài đặt và kiểm thử hệ thống “Quản lý môn học sinh viên” dựa trên công nghệ .NET WinForms và Entity Framework Core với cơ sở dữ liệu SQLite. Hệ thống hỗ trợ các nghiệp vụ chính: quản lý Danh mục (Sinh viên, Môn học, Học kỳ), Đăng ký học phần, Nhập điểm, Báo cáo/Thống kê theo học kỳ. Sản phẩm đạt được gồm: bộ mã nguồn hoàn chỉnh, dữ liệu mẫu sinh viên và môn học, các biểu mẫu nhập liệu dạng dialog, và bộ báo cáo tương tác theo bộ lọc. Hệ thống được thiết kế linh hoạt, có thể mở rộng để tích hợp ràng buộc chương trình đào tạo và tự động đăng ký các học phần bắt buộc.</p>

  <h2>LỜI CẢM ƠN</h2>
  <p>Em xin chân thành cảm ơn thầy PHƯƠNG VĂN CẢNH đã tận tình hướng dẫn và hỗ trợ em trong suốt quá trình thực hiện đồ án. Em cũng xin gửi lời cảm ơn đến các thầy cô Khoa Công nghệ Thông tin, Trường Đại học Điện Lực đã trang bị cho em nền tảng kiến thức vững chắc để hoàn thành đề tài. Cuối cùng, em cảm ơn gia đình và bạn bè đã luôn động viên, tạo điều kiện tốt nhất cho em trong quá trình học tập và nghiên cứu.</p>

  <div class="pagebreak"></div>

  <h2>MỤC LỤC</h2>
  <div class="toc">
    <ol>
      <li><a href="#chuong1">Chương 1: Tổng quan đề tài</a></li>
      <li><a href="#chuong2">Chương 2: Phân tích nghiệp vụ</a></li>
      <li><a href="#chuong3">Chương 3: Thiết kế hệ thống</a></li>
      <li><a href="#chuong4">Chương 4: Thiết kế cơ sở dữ liệu</a></li>
      <li><a href="#chuong5">Chương 5: Thiết kế giao diện và trải nghiệm</a></li>
      <li><a href="#chuong6">Chương 6: Cài đặt và triển khai</a></li>
      <li><a href="#chuong7">Chương 7: Kiểm thử và đánh giá</a></li>
      <li><a href="#chuong8">Chương 8: Vận hành và bảo trì</a></li>
      <li><a href="#chuong9">Chương 9: Hướng dẫn sử dụng</a></li>
      <li><a href="#chuong10">Chương 10: Kết luận và hướng phát triển</a></li>
      <li><a href="#thamkhao">Tài liệu tham khảo</a></li>
      <li><a href="#phuluc">Phụ lục</a></li>
    </ol>
  </div>

  <div class="pagebreak"></div>

  <h2 id="chuong1">Chương 1: Tổng quan đề tài</h2>
  <h3>1.1. Bối cảnh và động lực</h3>
  <p>Các hoạt động quản lý môn học và đăng ký học phần tại các trường đại học truyền thống thường thực hiện thủ công hoặc qua nhiều công cụ rời rạc, gây khó khăn trong tổng hợp số liệu, kiểm soát ràng buộc, và truy vết thay đổi. Đề tài hướng tới xây dựng một ứng dụng máy tính để bàn nhẹ, dễ triển khai, giúp số hóa quy trình nghiệp vụ, đảm bảo tính toàn vẹn dữ liệu và nâng cao hiệu quả quản trị.</p>
  <h3>1.2. Mục tiêu</h3>
  <ul>
    <li>Xây dựng ứng dụng WinForms đáp ứng nghiệp vụ: quản lý danh mục, đăng ký học phần, nhập điểm, báo cáo.</li>
    <li>Thiết kế cơ sở dữ liệu chặt chẽ, đảm bảo tính nhất quán và khả năng mở rộng.</li>
    <li>Cung cấp giao diện thân thiện, hỗ trợ nhập liệu qua dialog với kiểm tra ràng buộc.</li>
    <li>Xây dựng các biểu đồ phân tích (Use Case, ERD, Activity, Sequence, Class, Deployment).</li>
  </ul>
  <h3>1.3. Phạm vi</h3>
  <p>Phạm vi bao gồm bốn nhóm đối tượng: Sinh viên, Giảng viên, Cán bộ đào tạo, Quản trị. Chức năng gồm CRUD danh mục, đăng ký học phần, nhập điểm và báo cáo. Ngoài phạm vi: tích hợp hệ thống điểm danh, cổng thanh toán học phí, tích hợp LDAP/SSO.</p>
  <h3>1.4. Phương pháp và công cụ</h3>
  <ul>
    <li>Ngôn ngữ/Công nghệ: C# (.NET 8/9), WinForms, Entity Framework Core, SQLite.</li>
    <li>Công cụ: Visual Studio, dotnet CLI, Git/GitHub, Mermaid cho sơ đồ.</li>
    <li>Quy trình: Incremental/Iterative, kiểm thử hộp đen/hộp trắng.</li>
  </ul>

  <div class="pagebreak"></div>

  <h2 id="chuong2">Chương 2: Phân tích nghiệp vụ</h2>
  <h3>2.1. Tác nhân và ca sử dụng</h3>
  <pre class="mermaid">
flowchart LR
  A["Sinh viên"]:::actor
  GV["Giảng viên"]:::actor
  CBGD["Cán bộ đào tạo"]:::actor
  QT["Quản trị"]:::actor

  UC_Login([Đăng nhập])
  UC_StuEnroll([Đăng ký học phần])
  UC_ViewEnroll([Xem đăng ký])
  UC_ManageMaster([Quản lý danh mục])
  UC_EnterGrade([Nhập điểm])
  UC_Reports([Báo cáo])

  A-->UC_Login; A-->UC_StuEnroll; A-->UC_ViewEnroll
  GV-->UC_Login; GV-->UC_EnterGrade; GV-->UC_Reports
  CBGD-->UC_Login; CBGD-->UC_ManageMaster; CBGD-->UC_Reports
  QT-->UC_Login; QT-->UC_ManageMaster; QT-->UC_Reports

  classDef actor fill:#fff,stroke:#333
  </pre>
  <h3>2.2. Đặc tả ca sử dụng tiêu biểu</h3>
  <ul>
    <li>Đăng ký học phần: SV chọn học kỳ, chọn các môn, hệ thống kiểm tra trùng lịch/ràng buộc (giả lập ở phiên bản này), lưu đăng ký.</li>
    <li>Nhập điểm: GV chọn học kỳ/môn, nhập điểm cho danh sách SV đã đăng ký.</li>
    <li>Báo cáo: lọc theo học kỳ, môn học; hiển thị danh sách SV/điểm; hỗ trợ xuất/ in (có thể mở rộng).</li>
  </ul>
  <h3>2.3. Yêu cầu chức năng</h3>
  <ol>
    <li>Đăng nhập (admin/admin mặc định).</li>
    <li>Quản lý Sinh viên: thêm/sửa/xóa, tìm kiếm.</li>
    <li>Quản lý Môn học: mã môn, tên, số tín chỉ.</li>
    <li>Quản lý Học kỳ: mã học kỳ (ví dụ 2025-1), tên hiển thị.</li>
    <li>Đăng ký học phần: ràng buộc duy nhất (StudentId, CourseId, SemesterId).</li>
    <li>Nhập điểm: giá trị điểm 0..10, cho phép để trống nếu chưa chấm.</li>
    <li>Báo cáo: theo học kỳ; theo môn + học kỳ; kế hoạch học tập.</li>
  </ol>
  <h3>2.4. Yêu cầu phi chức năng</h3>
  <ul>
    <li>Hiệu năng: thao tác CRUD và lọc danh sách tức thì trên tập dữ liệu nhỏ-trung bình.</li>
    <li>Độ tin cậy: chống trùng lặp bằng unique index; xử lý lỗi bằng thông báo thân thiện.</li>
    <li>Khả dụng: ứng dụng dạng desktop, triển khai nhanh, không phụ thuộc hạ tầng phức tạp.</li>
    <li>Khả năng mở rộng: có thể nâng cấp lên kiến trúc client-server, tích hợp SSO.</li>
  </ul>
  <h3>2.5. Rủi ro và giả định</h3>
  <ul>
    <li>Rủi ro môi trường: phiên bản .NET/VS không tương thích (đã xử lý bằng hướng dẫn nâng cấp).</li>
    <li>Giả định: dữ liệu mẫu đủ đại diện; yêu cầu về lịch học/phòng học không nằm trong phạm vi.</li>
  </ul>

  <div class="pagebreak"></div>

  <h2 id="chuong3">Chương 3: Thiết kế hệ thống</h2>
  <h3>3.1. Kiến trúc tổng thể</h3>
  <p>Ứng dụng sử dụng mô hình phân lớp đơn giản: Tầng Giao diện (WinForms) – Tầng Dịch vụ/Mô hình (EF Core DbContext) – Tầng Dữ liệu (SQLite). Các form giao diện tương tác thông qua lớp dịch vụ/DbContext, sử dụng DTO để hiển thị lên DataGridView.</p>
  <h3>3.2. Sơ đồ triển khai</h3>
  <pre class="mermaid">
flowchart TB
  user((Người dùng)) --> app[Ứng dụng WinForms]
  app --> db[(SQLite file)]
  subgraph Máy trạm
    app
    db
  end
  style db fill:#eef,stroke:#99f
  </pre>
  <h3>3.3. Sơ đồ lớp (khái quát)</h3>
  <pre class="mermaid">
classDiagram
  class Student {+int Id;+string StudentCode;+string FullName;+Date DateOfBirth;+string ClassName}
  class Course {+int Id;+string CourseCode;+string Name;+int Credits}
  class Semester {+int Id;+string Code;+string Name}
  class Enrollment {+int Id;+int StudentId;+int CourseId;+int SemesterId;+double Grade}
  Student "1" --o "*" Enrollment : registers
  Course  "1" --o "*" Enrollment : contains
  Semester"1" --o "*" Enrollment : in
  </pre>
  <h3>3.4. Sơ đồ hoạt động: Đăng ký học phần</h3>
  <pre class="mermaid">
flowchart TD
  A[SV mở form Đăng ký] --> B[Chọn học kỳ]
  B --> C[Chọn môn học]
  C --> D{Kiểm tra trùng/đã đăng ký?}
  D -- Trùng --> E[Thông báo lỗi]
  D -- Không --> F[Lưu đăng ký]
  F --> G[Hiển thị danh sách]
  </pre>
  <h3>3.5. Sơ đồ tuần tự: Nhập điểm</h3>
  <pre class="mermaid">
sequenceDiagram
  actor GV as Giảng viên
  participant UI as Form Nhập điểm
  participant DB as DbContext
  GV->>UI: Chọn môn + học kỳ
  UI->>DB: Truy vấn danh sách đăng ký
  DB-->>UI: Danh sách SV
  GV->>UI: Nhập điểm một SV
  UI->>DB: Cập nhật Grade
  DB-->>UI: OK
  UI-->>GV: Hiển thị kết quả
  </pre>

  <div class="pagebreak"></div>

  <h2 id="chuong4">Chương 4: Thiết kế cơ sở dữ liệu</h2>
  <h3>4.1. ER Diagram</h3>
  <pre class="mermaid">
erDiagram
  STUDENTS { INT Id PK; STRING StudentCode; STRING FullName; DATE DateOfBirth; STRING ClassName }
  COURSES  { INT Id PK; STRING CourseCode; STRING Name; INT Credits }
  SEMESTERS{ INT Id PK; STRING Code; STRING Name }
  ENROLLMENTS{ INT Id PK; INT StudentId FK; INT CourseId FK; INT SemesterId FK; DOUBLE Grade }

  STUDENTS ||--o{ ENROLLMENTS : registers
  COURSES  ||--o{ ENROLLMENTS : has
  SEMESTERS||--o{ ENROLLMENTS : in
  </pre>
  <p>Thiết kế đảm bảo ràng buộc duy nhất trên <code>(StudentId, CourseId, SemesterId)</code> để ngăn trùng đăng ký. Các cột mã (StudentCode, CourseCode, Semester.Code) có unique index để thuận tiện tra cứu.</p>
  <h3>4.2. Lược đồ bảng</h3>
  <table>
    <thead><tr><th>Bảng</th><th>Thuộc tính</th><th>Kiểu</th><th>Ràng buộc</th></tr></thead>
    <tbody>
      <tr><td>Students</td><td>Id, StudentCode, FullName, DateOfBirth, ClassName</td><td>Int, Text, Date</td><td>PK(Id), Unique(StudentCode)</td></tr>
      <tr><td>Courses</td><td>Id, CourseCode, Name, Credits</td><td>Int, Text</td><td>PK(Id), Unique(CourseCode)</td></tr>
      <tr><td>Semesters</td><td>Id, Code, Name</td><td>Int, Text</td><td>PK(Id), Unique(Code)</td></tr>
      <tr><td>Enrollments</td><td>Id, StudentId, CourseId, SemesterId, Grade</td><td>Int, Double</td><td>PK(Id), FK, Unique(StudentId,CourseId,SemesterId)</td></tr>
    </tbody>
  </table>
  <h3>4.3. Chỉ mục và hiệu năng</h3>
  <p>Chỉ mục trên các cột khóa ngoại (StudentId, CourseId, SemesterId) giúp truy vấn nhanh theo từng chiều. Với quy mô dữ liệu môn tin học đại cương (~ vài nghìn bản ghi), SQLite đáp ứng tốt.</p>
  <h3>4.4. Dữ liệu mẫu và Seeder</h3>
  <p>Seeder khởi tạo ~50 sinh viên, ~40 môn học (CT101..CT140), 4 học kỳ, và đăng ký ngẫu nhiên để thuận tiện thử nghiệm.</p>

  <div class="pagebreak"></div>

  <h2 id="chuong5">Chương 5: Thiết kế giao diện và trải nghiệm</h2>
  <h3>5.1. Nguyên tắc</h3>
  <ul>
    <li>Sử dụng dialog riêng cho Thêm/Sửa nhằm giảm lỗi nhập và đơn giản thao tác.</li>
    <li>Kiểm tra dữ liệu phía giao diện: bắt buộc trường, định dạng ngày, phạm vi điểm.</li>
    <li>Đặt văn hóa <code>vi-VN</code> để hiển thị ngày-tháng kiểu dd/MM/yyyy.</li>
  </ul>
  <h3>5.2. Các màn hình chính</h3>
  <ul>
    <li>Đăng nhập: mặc định admin/admin; có thể mở rộng phân quyền.</li>
    <li>Tab Sinh viên/Môn học/Học kỳ/Đăng ký: DataGridView + nút Thêm/Sửa/Xóa/Lưu.</li>
    <li>Báo cáo: form tương tác lọc theo học kỳ; theo môn+học kỳ; kế hoạch học tập.</li>
  </ul>

  <div class="pagebreak"></div>

  <h2 id="chuong6">Chương 6: Cài đặt và triển khai</h2>
  <h3>6.1. Công nghệ và thư viện</h3>
  <ul>
    <li>.NET (WinForms), EF Core, SQLite.</li>
    <li>Mermaid dùng CDN để sinh sơ đồ trong tài liệu HTML.</li>
  </ul>
  <h3>6.2. Cấu trúc dự án</h3>
  <pre>
StudentManagement.Data/     (DbContext, Entities, Seeder)
StudentManagement.WinForms/ (Form chính, dialog, báo cáo)
docs/                       (Tài liệu HTML, sơ đồ)
  </pre>
  <h3>6.3. Điểm nhấn cài đặt</h3>
  <ul>
    <li>DTO cho DataGridView để tránh lỗi dynamic/ẩn cột.</li>
    <li>Xử lý lỗi tập trung với <code>try/catch</code> và thông báo thân thiện.</li>
    <li>Ràng buộc dữ liệu ở EF Core: unique index, khóa ngoại cascade.</li>
  </ul>

  <div class="pagebreak"></div>

  <h2 id="chuong7">Chương 7: Kiểm thử và đánh giá</h2>
  <h3>7.1. Chiến lược</h3>
  <ul>
    <li>Kiểm thử chức năng: CRUD, đăng ký, nhập điểm, lọc báo cáo.</li>
    <li>Kiểm thử biên: mã trùng, ngày sinh không hợp lệ, điểm ngoài phạm vi.</li>
    <li>Kiểm thử hiệu năng: tải danh sách với vài nghìn bản ghi.</li>
  </ul>
  <h3>7.2. Một số ca kiểm thử tiêu biểu</h3>
  <table>
    <thead><tr><th>Mã</th><th>Mô tả</th><th>Bước thực hiện</th><th>Kết quả mong đợi</th></tr></thead>
    <tbody>
      <tr><td>TC-ENR-01</td><td>Đăng ký trùng</td><td>Đăng ký lại cùng SV/Môn/HK</td><td>Bị chặn do unique</td></tr>
      <tr><td>TC-GRD-01</td><td>Điểm ngoài 0..10</td><td>Nhập -1 hoặc 11</td><td>Thông báo lỗi</td></tr>
      <tr><td>TC-LOGIN-01</td><td>Sai mật khẩu</td><td>admin / sai</td><td>Từ chối đăng nhập</td></tr>
    </tbody>
  </table>
  <h3>7.3. Đánh giá</h3>
  <p>Phiên bản hiện tại đáp ứng mục tiêu ban đầu, giao diện thân thiện, dữ liệu nhất quán. Có thể mở rộng để đáp ứng yêu cầu học thuật nâng cao như kế hoạch học tập theo CTĐT.</p>

  <div class="pagebreak"></div>

  <h2 id="chuong8">Chương 8: Vận hành và bảo trì</h2>
  <h3>8.1. Yêu cầu hệ thống</h3>
  <ul>
    <li>Windows 10/11; .NET Desktop Runtime 8+; SQLite.</li>
    <li>Khuyến nghị VS 2022 Community cho phát triển.</li>
  </ul>
  <h3>8.2. Sao lưu và phục hồi</h3>
  <p>Sao lưu file cơ sở dữ liệu SQLite định kỳ; khi phục hồi chỉ cần thay thế file cũ sau khi thoát ứng dụng.</p>

  <div class="pagebreak"></div>

  <h2 id="chuong9">Chương 9: Hướng dẫn sử dụng</h2>
  <ol>
    <li>Khởi động ứng dụng, đăng nhập với <code>admin/admin</code>.</li>
    <li>Quản lý danh mục tại các tab tương ứng; dùng nút Thêm/Sửa/Xóa/Lưu.</li>
    <li>Sử dụng menu Báo cáo để xem dữ liệu theo bộ lọc.</li>
  </ol>
  <p class="muted">Lưu ý: dữ liệu mẫu đã được khởi tạo tự động bởi Seeder.</p>

  <div class="pagebreak"></div>

  <h2 id="chuong10">Chương 10: Kết luận và hướng phát triển</h2>
  <p>Đề tài đã xây dựng thành công một hệ thống quản lý môn học sinh viên đầy đủ các chức năng cốt lõi, với thiết kế cơ sở dữ liệu chặt chẽ và giao diện thân thiện. Hướng phát triển gồm: ràng buộc chương trình đào tạo theo năm/kỳ, tự động gợi ý/hạn chế đăng ký, tích hợp xác thực tập trung và triển khai kiến trúc client-server.</p>

  <h2 id="thamkhao">Tài liệu tham khảo</h2>
  <ul>
    <li>Microsoft Docs: https://learn.microsoft.com/vi-vn/dotnet/</li>
    <li>Entity Framework Core: https://learn.microsoft.com/ef/core/</li>
    <li>SQLite: https://www.sqlite.org/docs.html</li>
    <li>Mermaid: https://mermaid.js.org/</li>
  </ul>

  <div class="pagebreak"></div>

  <h2 id="phuluc">Phụ lục</h2>
  <h3>A. Cấu hình văn hóa (vi-VN)</h3>
  <pre>
Thread.CurrentThread.CurrentCulture = new CultureInfo("vi-VN");
Thread.CurrentThread.CurrentUICulture = new CultureInfo("vi-VN");
  </pre>
  <h3>B. Ràng buộc unique Enrollments</h3>
  <pre>
modelBuilder.Entity<Enrollment>()
  .HasIndex(e => new { e.StudentId, e.CourseId, e.SemesterId })
  .IsUnique();
  </pre>
  <h3>C. Lệnh Git làm việc</h3>
  <pre>
git status
git add .
git commit -m "feat: ..."
git push -u origin feature/...
  </pre>

  <p class="muted">Tài liệu này được biên soạn dưới dạng HTML, có thể in ra PDF với chế độ A4; số trang thực tế phụ thuộc cỡ chữ và tùy chọn in.</p>
</body>
</html>
